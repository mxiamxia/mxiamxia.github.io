
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Node JS with express-jwt example</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="../favicon.ico">

    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=9a6ae4cf51">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">
    <link rel="stylesheet" type="text/css" href="../assets/css/prism.css?v=9a6ae4cf51"> 

    <link rel="canonical" href="index.html">
    <meta name="referrer" content="origin-when-cross-origin">
    
    <meta property="og:site_name" content="Tech and Life">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Node JS with express-jwt example">
    <meta property="og:description" content="JWT package express-jwt jsonwebtoken Step 1, Client side sends the login request to server with ID and password. Step 2, If server side verified ID and password successfully, it will return the signed jwt token to client, and also store the jwt token to Redis or DB for further verification.">
    <meta property="og:url" content="http://localhost:2368/node-js-jwt-web-app/">
    <meta property="article:published_time" content="2016-05-20T19:41:08.000Z">
    <meta property="article:modified_time" content="2016-05-20T19:49:33.000Z">
    <meta property="article:tag" content="Node JS">
    <meta property="article:tag" content="jwt">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Node JS with express-jwt example">
    <meta name="twitter:description" content="JWT package express-jwt jsonwebtoken Step 1, Client side sends the login request to server with ID and password. Step 2, If server side verified ID and password successfully, it will return the signed jwt token to client, and also store the jwt token to Redis or DB for further verification.">
    <meta name="twitter:url" content="http://localhost:2368/node-js-jwt-web-app/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="mxia">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Node JS, jwt">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Tech and Life",
        "logo": "http://localhost:2368/ghost/img/ghosticon.jpg"
    },
    "author": {
        "@type": "Person",
        "name": "mxia",
        "url": "http://localhost:2368/author/mxia/",
        "sameAs": []
    },
    "headline": "Node JS with express-jwt example",
    "url": "http://localhost:2368/node-js-jwt-web-app/",
    "datePublished": "2016-05-20T19:41:08.000Z",
    "dateModified": "2016-05-20T19:49:33.000Z",
    "keywords": "Node JS, jwt",
    "description": "JWT package express-jwt jsonwebtoken Step 1, Client side sends the login request to server with ID and password. Step 2, If server side verified ID and password successfully, it will return the signed jwt token to client, and also store the jwt token to Redis or DB for further verification."
}
    </script>

    <meta name="generator" content="Ghost 0.9">
    <link rel="alternate" type="application/rss+xml" title="Tech and Life" href="../rss/index.html">
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62982905-1', 'auto');
  ga('send', 'pageview');

</script>

<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-55770ac61cd13df8" async="async"></script>
</head>
<body class="post-template tag-node-js tag-jwt nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-home" role="presentation"><a href="../">Home</a></li>
    </ul>
    <a class="subscribe-button icon-feed" href="../rss/index.rss">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-node-js tag-jwt">

        <header class="post-header">
            <h1 class="post-title">Node JS with express-jwt example</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2016-05-20">20 May 2016</time>  on <a href="../tag/node-js/">Node JS</a>, <a href="../tag/jwt/">jwt</a>
            </section>
        </header>

        <section class="post-content">
            <h3 id="jwtpackage">JWT package</h3>

<ul>
<li>express-jwt</li>
<li>jsonwebtoken</li>
</ul>

<h6 id="step1">Step 1,</h6>

<p>Client side sends the login request to server with ID and password.</p>

<h6 id="step2">Step 2,</h6>

<p>If server side verified ID and password successfully, it will return the signed jwt token to client, and also store the jwt token to Redis or DB for further verification.  </p>

<pre><code class="language-js">var jwt = require('jsonwebtoken');  
var secretToken = 'aMdoeb5ed87zorRdkD6greDML81DcnrzeSD648ferFejmplx';  
var token = jwt.sign({id: user._id}, secretToken, { expiresInMinutes: tokenManager.TOKEN_EXPIRATION });  
return res.json({token:token});  
</code></pre>

<h6 id="step3">Step 3,</h6>

<p>When Client Side gets the login response with token, it should store the jwt token to client side(localStorage) and send the token for every future request, Suggest to use client side interceptor to do the job. <br>
AngularJS Example,  </p>

<pre><code class="language-js">appServices.factory('TokenInterceptor', function ($q, $window, $location, AuthenticationService) {  
    return {
        request: function (config) {
            config.headers = config.headers || {};
            if ($window.sessionStorage.token) {
                config.headers.Authorization = 'Bearer ' + $window.sessionStorage.token;
            }
            return config;
        }
}

app.config(function ($httpProvider) {  
    $httpProvider.interceptors.push('TokenInterceptor');
});
</code></pre>

<h6 id="step4">Step 4,</h6>

<p>For every request which needs be authorized, we add jwt (express-jwt) middleware for the request, jwt middleware will put decoded token in req.user for each request if the token is verified(can be decoded by secret), then we can verify the value in the req.user to see if it matches the token we generated/stored in step 1.  </p>

<pre><code class="language-js">var jwt = require('express-jwt');  
app.get('/post/create', jwt({secret:secretToken}), routes.users.care);  
</code></pre>
	    <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'mintechandlife';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        </section>

        <footer class="post-footer">



            <section class="author">
                <h4><a href="../author/mxia/">mxia</a></h4>

                    <p>Read <a href="../author/mxia/">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/share?text=Node%20JS%20with%20express-jwt%20example&amp;url=http://localhost:2368/node-js-jwt-web-app/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/node-js-jwt-web-app/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://localhost:2368/node-js-jwt-web-app/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>

    </article>
</main>

<aside class="read-next">
    <a class="read-next-story no-cover" href="../add-two-numbers-with-bit-operation/">
        <section class="post">
            <h2>Add Two Numbers With Bit Operation</h2>
            <p>Question： Calculate the sum of two integers a and b, but you are not allowed to use the operator…</p>
        </section>
    </a>
    <a class="read-next-story prev no-cover" href="../debug-node-js-by-node-inspector/">
        <section class="post">
            <h2>Debug Node JS by node-inspector</h2>
            <p>First, you have to install node-inspector package from NPM   npm install -g node-inspector   Run node inspector before starting your…</p>
        </section>
    </a>
</aside>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="../">Tech and Life</a> © 2016</section>
            <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
        </footer>

    </div>

    <!-- You can safely delete this line if your theme does not require jQuery -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=9a6ae4cf51"></script>
    <script type="text/javascript" src="../assets/js/index.js?v=9a6ae4cf51"></script>
    <script type="text/javascript" src="../assets/js/prism.js?v=9a6ae4cf51"></script>
</body>
